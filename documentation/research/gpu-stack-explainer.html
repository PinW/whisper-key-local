<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPU Stack Explainer: CUDA vs ROCm</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 40px 20px;
            line-height: 1.6;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        h1 {
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #76b852, #8DC26F);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            text-align: center;
            color: #888;
            margin-bottom: 40px;
            font-size: 1.1rem;
        }

        h2 {
            color: #8DC26F;
            margin: 40px 0 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #333;
        }

        h3 {
            color: #76b852;
            margin: 30px 0 15px;
        }

        p {
            margin-bottom: 15px;
            color: #ccc;
        }

        .highlight {
            color: #8DC26F;
            font-weight: bold;
        }

        .stacks-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin: 30px 0;
        }

        @media (max-width: 900px) {
            .stacks-container {
                grid-template-columns: 1fr;
            }
        }

        .stack {
            background: rgba(255,255,255,0.03);
            border-radius: 16px;
            padding: 25px;
            border: 1px solid #333;
        }

        .stack-title {
            text-align: center;
            font-size: 1.4rem;
            margin-bottom: 20px;
            padding: 10px;
            border-radius: 8px;
        }

        .stack-nvidia .stack-title {
            background: linear-gradient(90deg, #76b900, #5a8f00);
            color: white;
        }

        .stack-amd .stack-title {
            background: linear-gradient(90deg, #ed1c24, #c41e3a);
            color: white;
        }

        .layer {
            margin: 10px 0;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            position: relative;
        }

        .layer-app {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .layer-lib {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }

        .layer-engine {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: #1a1a2e;
        }

        .layer-runtime-cuda {
            background: linear-gradient(135deg, #76b900 0%, #5a8f00 100%);
        }

        .layer-runtime-rocm {
            background: linear-gradient(135deg, #ed1c24 0%, #c41e3a 100%);
        }

        .layer-hardware-nvidia {
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            border: 2px solid #76b900;
        }

        .layer-hardware-amd {
            background: linear-gradient(135deg, #2d2d2d 0%, #1a1a1a 100%);
            border: 2px solid #ed1c24;
        }

        .layer-name {
            font-weight: bold;
            font-size: 1.1rem;
        }

        .layer-detail {
            font-size: 0.85rem;
            opacity: 0.9;
            margin-top: 5px;
        }

        .arrow {
            text-align: center;
            font-size: 1.5rem;
            color: #666;
            margin: 5px 0;
        }

        .wheel-explainer {
            background: rgba(255,255,255,0.05);
            border-radius: 16px;
            padding: 30px;
            margin: 40px 0;
            border: 1px solid #444;
        }

        .wheel-diagram {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
            margin: 30px 0;
        }

        .wheel-box {
            padding: 20px 30px;
            border-radius: 12px;
            text-align: center;
            min-width: 200px;
        }

        .wheel-pypi {
            background: linear-gradient(135deg, #3775a9 0%, #2b5f8a 100%);
        }

        .wheel-github {
            background: linear-gradient(135deg, #333 0%, #1a1a1a 100%);
            border: 2px solid #666;
        }

        .wheel-source {
            background: linear-gradient(135deg, #f39c12 0%, #d68910 100%);
            color: #1a1a2e;
        }

        .arrow-horizontal {
            font-size: 2rem;
            color: #666;
        }

        .problem-box {
            background: linear-gradient(135deg, #c0392b22 0%, #e74c3c22 100%);
            border: 2px solid #c0392b;
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
        }

        .problem-box h3 {
            color: #e74c3c;
        }

        .solution-box {
            background: linear-gradient(135deg, #27ae6022 0%, #2ecc7122 100%);
            border: 2px solid #27ae60;
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
        }

        .solution-box h3 {
            color: #2ecc71;
        }

        code {
            background: rgba(0,0,0,0.3);
            padding: 3px 8px;
            border-radius: 4px;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9rem;
            color: #8DC26F;
        }

        .code-block {
            background: #0d0d0d;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Monaco', 'Consolas', monospace;
            font-size: 0.9rem;
            line-height: 1.8;
        }

        .code-block .comment {
            color: #666;
        }

        .code-block .command {
            color: #8DC26F;
        }

        .hip-explainer {
            background: rgba(237, 28, 36, 0.1);
            border: 2px solid #ed1c24;
            border-radius: 12px;
            padding: 25px;
            margin: 30px 0;
        }

        .hip-explainer h3 {
            color: #ed1c24;
        }

        .translation-diagram {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 15px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .translate-box {
            padding: 15px 25px;
            border-radius: 8px;
            text-align: center;
            font-weight: bold;
        }

        .translate-cuda {
            background: #76b900;
            color: white;
        }

        .translate-hip {
            background: #ed1c24;
            color: white;
        }

        .translate-arrow {
            font-size: 1.5rem;
            color: #888;
        }

        .timeline {
            margin: 30px 0;
            padding-left: 30px;
            border-left: 3px solid #444;
        }

        .timeline-item {
            position: relative;
            padding: 15px 0 15px 25px;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: -9px;
            top: 20px;
            width: 15px;
            height: 15px;
            border-radius: 50%;
            background: #8DC26F;
        }

        .timeline-item.past::before {
            background: #666;
        }

        .timeline-item.current::before {
            background: #f39c12;
            box-shadow: 0 0 10px #f39c12;
        }

        .timeline-date {
            color: #888;
            font-size: 0.9rem;
        }

        .timeline-title {
            font-weight: bold;
            color: #e0e0e0;
        }

        .gpu-compat {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .gpu-card {
            background: rgba(255,255,255,0.03);
            border-radius: 12px;
            padding: 20px;
            border: 1px solid #333;
        }

        .gpu-card-title {
            font-weight: bold;
            margin-bottom: 10px;
            padding-bottom: 10px;
            border-bottom: 1px solid #333;
        }

        .gpu-good { color: #2ecc71; }
        .gpu-maybe { color: #f39c12; }
        .gpu-bad { color: #e74c3c; }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 10px;
        }

        .badge-working { background: #27ae60; }
        .badge-partial { background: #f39c12; color: #1a1a2e; }
        .badge-broken { background: #c0392b; }

        footer {
            text-align: center;
            margin-top: 60px;
            padding-top: 30px;
            border-top: 1px solid #333;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üé§ Whisper GPU Acceleration Stack</h1>
        <p class="subtitle">Understanding how CUDA, ROCm, and Python wheels fit together</p>

        <!-- Section 1: The Two Stacks -->
        <h2>1. The Full Stack: NVIDIA vs AMD</h2>
        <p>When you run Whisper with GPU acceleration, your code goes through several layers before reaching the hardware. Here's how the stacks compare:</p>

        <div class="stacks-container">
            <div class="stack stack-nvidia">
                <div class="stack-title">üü¢ NVIDIA Stack (Current)</div>

                <div class="layer layer-app">
                    <div class="layer-name">Whisper-Key</div>
                    <div class="layer-detail">Your app ‚Ä¢ config says device: "cuda"</div>
                </div>
                <div class="arrow">‚Üì</div>

                <div class="layer layer-lib">
                    <div class="layer-name">faster-whisper</div>
                    <div class="layer-detail">Python library ‚Ä¢ speech-to-text API</div>
                </div>
                <div class="arrow">‚Üì</div>

                <div class="layer layer-engine">
                    <div class="layer-name">CTranslate2</div>
                    <div class="layer-detail">Inference engine ‚Ä¢ runs the AI model</div>
                </div>
                <div class="arrow">‚Üì</div>

                <div class="layer layer-runtime-cuda">
                    <div class="layer-name">CUDA + cuDNN + cuBLAS</div>
                    <div class="layer-detail">NVIDIA's GPU libraries</div>
                </div>
                <div class="arrow">‚Üì</div>

                <div class="layer layer-hardware-nvidia">
                    <div class="layer-name">üñ•Ô∏è NVIDIA GPU</div>
                    <div class="layer-detail">RTX 3080, 4090, etc.</div>
                </div>
            </div>

            <div class="stack stack-amd">
                <div class="stack-title">üî¥ AMD Stack (New!)</div>

                <div class="layer layer-app">
                    <div class="layer-name">Whisper-Key</div>
                    <div class="layer-detail">Your app ‚Ä¢ config STILL says device: "cuda"</div>
                </div>
                <div class="arrow">‚Üì</div>

                <div class="layer layer-lib">
                    <div class="layer-name">faster-whisper</div>
                    <div class="layer-detail">Python library ‚Ä¢ unchanged</div>
                </div>
                <div class="arrow">‚Üì</div>

                <div class="layer layer-engine" style="border: 3px solid #ed1c24;">
                    <div class="layer-name">CTranslate2 (ROCm build) ‚≠ê</div>
                    <div class="layer-detail">Same engine, different compile!</div>
                </div>
                <div class="arrow">‚Üì</div>

                <div class="layer layer-runtime-rocm">
                    <div class="layer-name">ROCm + HIP + rocBLAS</div>
                    <div class="layer-detail">AMD's GPU libraries</div>
                </div>
                <div class="arrow">‚Üì</div>

                <div class="layer layer-hardware-amd">
                    <div class="layer-name">üñ•Ô∏è AMD GPU</div>
                    <div class="layer-detail">RX 7900, 6800, 5700 XT, etc.</div>
                </div>
            </div>
        </div>

        <p>Notice how the <span class="highlight">only difference</span> is at the CTranslate2 layer! The app code and config stay exactly the same. This is because AMD's HIP is designed to be CUDA-compatible.</p>

        <!-- Section 2: The HIP Translation Layer -->
        <div class="hip-explainer">
            <h3>üîÑ What is HIP? (The Magic Translation Layer)</h3>
            <p>HIP (Heterogeneous-computing Interface for Portability) is AMD's secret weapon. It translates CUDA API calls to AMD GPU calls automatically:</p>

            <div class="translation-diagram">
                <div class="translate-box translate-cuda">
                    <div>Your Code</div>
                    <code>device="cuda"</code>
                </div>
                <div class="translate-arrow">‚Üí</div>
                <div class="translate-box translate-hip">
                    <div>HIP Layer</div>
                    <code>translates calls</code>
                </div>
                <div class="translate-arrow">‚Üí</div>
                <div class="translate-box translate-hip">
                    <div>AMD GPU</div>
                    <code>executes</code>
                </div>
            </div>

            <p>This is why you <strong>don't</strong> change "cuda" to "rocm" in your config. The HIP layer intercepts CUDA calls and handles them. It's like a universal translator!</p>
        </div>

        <!-- Section 3: What are Wheels? -->
        <h2>2. What Are "Wheels"? üì¶</h2>

        <div class="wheel-explainer">
            <p>A <span class="highlight">wheel</span> is a pre-compiled Python package. Think of it like a ready-to-install app vs. building from source code.</p>

            <h3>The Compilation Problem</h3>
            <p>CTranslate2 is written in C++ and needs to be <strong>compiled</strong> (built) before Python can use it. During compilation, you choose which GPU backend to enable:</p>

            <div class="code-block">
                <span class="comment"># When building CTranslate2, you pick ONE:</span><br>
                <span class="command">cmake -DWITH_CUDA=ON ...</span>  <span class="comment"># ‚Üí NVIDIA wheel</span><br>
                <span class="command">cmake -DWITH_HIP=ON ...</span>   <span class="comment"># ‚Üí AMD wheel</span><br>
                <span class="command">cmake -DWITH_MKL=ON ...</span>   <span class="comment"># ‚Üí CPU-only wheel</span>
            </div>

            <p>Once compiled, you get a <code>.whl</code> file that can be installed with pip. But here's the catch...</p>

            <h3>Where Wheels Come From</h3>

            <div class="wheel-diagram">
                <div class="wheel-box wheel-pypi">
                    <div style="font-size: 1.3rem; margin-bottom: 10px;">üì¶ PyPI</div>
                    <div style="font-size: 0.9rem;">pip install ctranslate2</div>
                    <div style="margin-top: 10px; padding: 8px; background: rgba(0,0,0,0.2); border-radius: 6px;">
                        ‚úÖ CUDA wheel<br>
                        ‚úÖ CPU wheel<br>
                        ‚ùå <strong>No ROCm wheel!</strong>
                    </div>
                </div>

                <div class="arrow-horizontal">‚Üí</div>

                <div class="wheel-box wheel-github">
                    <div style="font-size: 1.3rem; margin-bottom: 10px;">üêô GitHub Releases</div>
                    <div style="font-size: 0.9rem;">Manual download</div>
                    <div style="margin-top: 10px; padding: 8px; background: rgba(255,255,255,0.1); border-radius: 6px;">
                        ‚úÖ CUDA wheel<br>
                        ‚úÖ CPU wheel<br>
                        ‚úÖ <strong>ROCm wheel!</strong>
                    </div>
                </div>

                <div class="arrow-horizontal">‚Üí</div>

                <div class="wheel-box wheel-source">
                    <div style="font-size: 1.3rem; margin-bottom: 10px;">üîß Build from Source</div>
                    <div style="font-size: 0.9rem;">Compile yourself</div>
                    <div style="margin-top: 10px; padding: 8px; background: rgba(0,0,0,0.2); border-radius: 6px;">
                        ‚úÖ Any configuration<br>
                        ‚úÖ Any GPU arch<br>
                        ‚ö†Ô∏è Complex setup
                    </div>
                </div>
            </div>
        </div>

        <!-- Section 4: The Problem for AMD Users -->
        <div class="problem-box">
            <h3>üö´ The Problem for AMD Users</h3>
            <p>When you run <code>pip install faster-whisper</code>, it automatically installs CTranslate2 from PyPI. PyPI only has the <strong>CUDA wheel</strong>, so even with an AMD GPU and ROCm installed, you get a CTranslate2 that can't talk to your GPU!</p>

            <div class="code-block">
                <span class="comment"># What happens today:</span><br><br>
                <span class="command">pip install faster-whisper</span><br>
                <span class="comment"># ‚îî‚îÄ installs ctranslate2 (CUDA version) from PyPI</span><br>
                <span class="comment"># ‚îî‚îÄ your AMD GPU sits unused üò¢</span><br>
                <span class="comment"># ‚îî‚îÄ falls back to CPU</span>
            </div>
        </div>

        <div class="solution-box">
            <h3>‚úÖ The Solution (Manual Steps Required)</h3>
            <p>To use your AMD GPU, you need to swap out the CTranslate2 wheel:</p>

            <div class="code-block">
                <span class="comment"># Step 1: Install faster-whisper (gets CUDA ctranslate2)</span><br>
                <span class="command">pip install faster-whisper</span><br><br>

                <span class="comment"># Step 2: Remove the CUDA version</span><br>
                <span class="command">pip uninstall ctranslate2</span><br><br>

                <span class="comment"># Step 3: Download ROCm wheel from GitHub releases</span><br>
                <span class="comment"># https://github.com/OpenNMT/CTranslate2/releases</span><br>
                <span class="command">pip install ctranslate2-4.7.1-...-rocm.whl</span><br><br>

                <span class="comment"># Now device="cuda" will use your AMD GPU via HIP! üéâ</span>
            </div>
        </div>

        <!-- Section 5: Timeline -->
        <h2>3. How We Got Here (Timeline)</h2>

        <div class="timeline">
            <div class="timeline-item past">
                <div class="timeline-date">August 2023</div>
                <div class="timeline-title">CTranslate2 maintainer declines ROCm priority</div>
                <p>Issue #1072 opened, but no resources to implement</p>
            </div>
            <div class="timeline-item past">
                <div class="timeline-date">2023-2024</div>
                <div class="timeline-title">Community forks emerge</div>
                <p>arlo-phoenix/CTranslate2-rocm provides working builds</p>
            </div>
            <div class="timeline-item past">
                <div class="timeline-date">October 2024</div>
                <div class="timeline-title">AMD publishes ROCm blog post</div>
                <p>Official documentation for CTranslate2 on AMD GPUs</p>
            </div>
            <div class="timeline-item past">
                <div class="timeline-date">March 2024</div>
                <div class="timeline-title">Tensile PR #1897 merged</div>
                <p>Adds fallback kernels for gfx1010 (RDNA1) in ROCm 6.1+</p>
            </div>
            <div class="timeline-item current">
                <div class="timeline-date">February 2, 2026</div>
                <div class="timeline-title">üéâ PR #1989 merged - Official ROCm support!</div>
                <p>CTranslate2 now officially supports AMD GPUs via HIP</p>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">February 4, 2026</div>
                <div class="timeline-title">CTranslate2 v4.7.1 released</div>
                <p>First release with ROCm wheels on GitHub</p>
            </div>
            <div class="timeline-item">
                <div class="timeline-date">Future?</div>
                <div class="timeline-title">ROCm wheels on PyPI?</div>
                <p>Would make <code>pip install</code> just work for AMD users</p>
            </div>
        </div>

        <!-- Section 6: Your GPU (5700 XT) -->
        <h2>4. Where Does the RX 5700 XT Fit?</h2>

        <div class="gpu-compat">
            <div class="gpu-card">
                <div class="gpu-card-title gpu-good">RDNA 3 (RX 7000 series) <span class="status-badge badge-working">Working</span></div>
                <p>gfx1100, gfx1101, gfx1102</p>
                <p>Best support, primary target</p>
            </div>
            <div class="gpu-card">
                <div class="gpu-card-title gpu-maybe">RDNA 2 (RX 6000 series) <span class="status-badge badge-partial">Likely Works</span></div>
                <p>gfx1030, gfx1031</p>
                <p>Limited testing but should work</p>
            </div>
            <div class="gpu-card" style="border: 2px solid #f39c12;">
                <div class="gpu-card-title gpu-maybe">RDNA 1 (RX 5000 series) <span class="status-badge badge-partial">You Are Here</span></div>
                <p>gfx1010 (5700 XT)</p>
                <p>ROCm 6.1+ has fallback kernels thanks to Tensile fix. May work but not officially supported. Needs testing!</p>
            </div>
            <div class="gpu-card">
                <div class="gpu-card-title gpu-bad">GCN (RX 500/Vega) <span class="status-badge badge-broken">Community Only</span></div>
                <p>gfx803, gfx900, gfx906</p>
                <p>Requires HSA_OVERRIDE_GFX_VERSION hack</p>
            </div>
        </div>

        <div class="solution-box">
            <h3>üéØ Your Best Path Forward (5700 XT)</h3>
            <ol style="margin-left: 20px; margin-top: 15px;">
                <li style="margin-bottom: 10px;"><strong>Option A: Try whisper.cpp + Vulkan</strong> - Avoids ROCm complexity entirely, GPU-agnostic</li>
                <li style="margin-bottom: 10px;"><strong>Option B: Try the official ROCm wheel</strong> - Download from GitHub, might just work with ROCm 6.1+</li>
                <li style="margin-bottom: 10px;"><strong>Option C: Stick with CPU</strong> - faster-whisper with int8 is still fast for short clips</li>
            </ol>
        </div>

        <!-- Section 7: Visual Summary -->
        <h2>5. TL;DR - One Picture</h2>

        <div style="background: rgba(255,255,255,0.03); border-radius: 16px; padding: 30px; margin: 30px 0; border: 1px solid #333;">
            <div style="text-align: center; margin-bottom: 20px;">
                <code style="font-size: 1.2rem; padding: 10px 20px;">pip install faster-whisper</code>
            </div>

            <div style="display: flex; justify-content: center; gap: 40px; flex-wrap: wrap;">
                <div style="text-align: center;">
                    <div style="font-size: 3rem;">üü¢</div>
                    <div style="font-weight: bold; color: #76b900;">NVIDIA User</div>
                    <div style="color: #888; margin-top: 10px;">Just works‚Ñ¢</div>
                    <div style="color: #666; font-size: 0.9rem;">PyPI has CUDA wheel</div>
                </div>

                <div style="text-align: center;">
                    <div style="font-size: 3rem;">üî¥</div>
                    <div style="font-weight: bold; color: #ed1c24;">AMD User</div>
                    <div style="color: #888; margin-top: 10px;">Extra steps needed</div>
                    <div style="color: #666; font-size: 0.9rem;">Must swap wheel manually</div>
                </div>
            </div>

            <div style="text-align: center; margin-top: 30px; padding-top: 20px; border-top: 1px solid #333;">
                <p style="color: #888;">The code is the same. The config is the same.<br>The <span class="highlight">compiled library</span> is different.</p>
            </div>
        </div>

        <footer>
            <p>Created for Whisper-Key documentation ‚Ä¢ February 2026</p>
            <p style="margin-top: 10px;"><a href="https://github.com/PinW/whisper-key-local" style="color: #8DC26F;">github.com/PinW/whisper-key-local</a></p>
        </footer>
    </div>
</body>
</html>
